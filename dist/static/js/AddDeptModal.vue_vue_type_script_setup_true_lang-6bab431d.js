import{u as e,g as a,s as l}from"./useDept-08ceeaa6.js";import{d as t,r as d,B as s,f as o,o as u,t as i,w as r,g as n,i as m,k as c,M as p}from"./index-e52c4d6b.js";import{u as f}from"./useForm-aa6017f5.js";const h=t({__name:"AddDeptModal",setup(t,{expose:h}){const v=d(),V=d(""),w=d(!1),b=s((()=>!!V.value)),x=s((()=>b.value?"编辑部门":"新增部门")),{deptList:_,getDeptList:g}=e();g();const{form:k,resetForm:y}=f({id:"",parentId:"",name:"",sort:0,status:1,description:""}),U={name:[{required:!0,message:"请输入部门名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}]},j=()=>{var e;null==(e=v.value)||e.resetFields(),y()};h({add:()=>{V.value="",w.value=!0},edit:async e=>{_.value.length||await g(),V.value=e;const l=await a({id:e});Object.assign(k,l.data),w.value=!0}});const F=async()=>{var e;try{if(await(null==(e=v.value)?void 0:e.validate()))return!1;return!!(await l(k)).data&&(p.success("模拟保存成功"),!0)}catch(a){return!1}};return(e,a)=>{const l=o("a-tree-select"),t=o("a-form-item"),d=o("a-input"),s=o("a-input-number"),p=o("a-textarea"),f=o("a-switch"),h=o("a-form"),V=o("a-modal");return u(),i(V,{visible:m(w),"onUpdate:visible":a[5]||(a[5]=e=>c(w)?w.value=e:null),title:m(x),width:"90%","modal-style":{maxWidth:"520px"},"mask-closable":!1,onBeforeOk:F,onClose:j},{default:r((()=>[n(h,{ref_key:"FormRef",ref:v,model:m(k),rules:U,size:"medium","auto-label-width":""},{default:r((()=>[n(t,{label:"上级部门",field:"parentId"},{default:r((()=>[n(l,{modelValue:m(k).parentId,"onUpdate:modelValue":a[0]||(a[0]=e=>m(k).parentId=e),"allow-clear":"",data:m(_),placeholder:"请选择上级部门",fieldNames:{key:"id",title:"name",children:"children"}},null,8,["modelValue","data"])])),_:1}),n(t,{label:"部门名称",field:"name"},{default:r((()=>[n(d,{modelValue:m(k).name,"onUpdate:modelValue":a[1]||(a[1]=e=>m(k).name=e),modelModifiers:{trim:!0},placeholder:"请输入部门名称","allow-clear":"","max-length":10},null,8,["modelValue"])])),_:1}),n(t,{label:"排序",field:"sort"},{default:r((()=>[n(s,{modelValue:m(k).sort,"onUpdate:modelValue":a[2]||(a[2]=e=>m(k).sort=e),style:{width:"120px"}},null,8,["modelValue"])])),_:1}),n(t,{label:"描述",field:"description"},{default:r((()=>[n(p,{modelValue:m(k).description,"onUpdate:modelValue":a[3]||(a[3]=e=>m(k).description=e),modelModifiers:{trim:!0},"max-length":200,placeholder:"请填写描述","auto-size":{minRows:3},"show-word-limit":""},null,8,["modelValue"])])),_:1}),n(t,{label:"状态",field:"status"},{default:r((()=>[n(f,{type:"round",modelValue:m(k).status,"onUpdate:modelValue":a[4]||(a[4]=e=>m(k).status=e),"checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])}}});export{h as _};

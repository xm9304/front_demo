import{u as e}from"./usePagination-d0044bb3.js";import{r as a,V as t,M as s}from"./index-f2e976d2.js";function n(n,l){const{formatResult:o,onSuccess:c,immediate:i,rowKey:r}=l||{},{pagination:u,setTotal:d}=e((()=>m())),v=a(!1),g=a([]),m=async()=>{try{v.value=!0;const e=await n({page:u.current,size:u.pageSize});g.value=o?o(e.data.records):e.data.records,d(e.data.total),c&&c()}finally{v.value=!1}};(i??!0)&&m();const p=a([]);return{loading:v,tableData:g,getTableData:m,search:()=>{p.value=[],u.onChange(1)},pagination:u,selectedKeys:p,select:e=>{p.value=e},selectAll:e=>{const a=r??"id",t=g.value.filter((e=>!e.disabled));p.value=e?t.map((e=>e[a])):[]},handleDelete:async(e,a)=>{const n=async()=>{try{const t=await e();return t.success&&(s.success((null==a?void 0:a.successTip)||"删除成功！"),p.value=[],m()),t.success}catch(t){return!1}};if(!((null==a?void 0:a.showModal)??!0))return n();t.warning({title:(null==a?void 0:a.title)||"提示",content:(null==a?void 0:a.content)||"是否确认删除？",hideCancel:!1,maskClosable:!1,onBeforeOk:n})}}}export{n as u};
